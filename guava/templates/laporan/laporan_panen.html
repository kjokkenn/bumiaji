{% extends "base/base.html" %}

{% block content %}


<div class="row">
    <div class="col-lg-12 grid-margin stretch-card">
        
        <div class="card">
            <div class="card-body">
                <div class="table-responsive">
                    <div class="form-group">
                        <form class="form-inline" method="get">
                           
                                <label for="mulai" class="col-form-label">Tanggal Awal</label>
                                <input class="form-control form-control-sm mb-2 mr-sm-2 ml-2" type="date" value="{{mulai|date:'Y-m-d'}}" name="mulai" id="mulai">
                    
                                <label for="akhir" class="col-form-label">Tanggal Akhir</label>
                                <input class="form-control form-control-sm  mb-2 mr-sm-2 ml-2" type="date"value="{{akhir|date:'Y-m-d'}}" name="akhir" id="akhir">
                    
                                <label for="jenis_panen" class="col-form-label">Jenis Panen</label>
                                <select class="form-control form-control-sm  mb-2 mr-sm-2 ml-2" name="jenis_panen" id="jenis_panen">
                                    <option value="panen mitra" {% if jenis_panen == "panen mitra" %} selected {% endif %}>Panen Mitra</option>
                                    <option value="panen lokal" {% if jenis_panen == "panen lokal" %} selected {% endif %}>Panen Lokal</option>
                                </select>
                                <button class="btn btn-primary ml-2 mb-2" type="submit">Submit</button>
                            
                        </form>
                    </div>
                    {% if detailobj %}
                    <h3 class="card-title">Laporan {{jenis_panen}}</h3>
                    <table class="table table-bordered" id="laporanmitra">
                        <thead class="table-light">
                            <tr>
                                <td>No</td>
                                <td>Tanggal</td>
                                <td>Nama Mitra</td>
                                <td>Nama Komoditas</td>
                                <td>Harga Komoditas</td>
                                <td>Jumlah Komoditas</td>
                                <td>Tanggal Kadaluwarsa</td>
                                <td>Subtotal</td>
                                <td>Total</td>
                            </tr>
                        </thead>
                        <tbody class="table-dark">
                            {% for item in detailobj %}
                            <tr>
                                <td>{{forloop.counter}}</td>
                                <td>{{item.0.tanggal_panen}}</td>
                                <td>{{item.0.id_mitra}}</td>
                                <td>
                                    <ul class="mt-2">

                                        {% for detail in item.1 %}
                                            <li >{{detail.id_komoditas}}</li>
                                        {% endfor %}
                                    </ul>
                                </td>
                                <td>
                                    <ul class="mt-2">
                                        
                                        {% for detail in item.1 %}
                                            <li class="mb-2">Rp{{detail.id_komoditas.harga_beli}}</li>
                                        {% endfor %}
                                    </ul>
                                </td>
                                <td>
                                    <ul class="mt-2">
                                        
                                        {% for detail in item.1 %}
                                            <li class="mb-2">{{detail.kuantitas}}</li>
                                        {% endfor %}
                                    </ul>
                                </td>
                                <td>
                                    <ul class="mt-2">
                                        
                                        {% for detail in item.1 %}
                                            <li class="mb-2">{{detail.tanggal_kadaluwarsa}}</li>
                                        {% endfor %}
                                    </ul>
                                </td>
                
                                <td>
                                    <ul class="mt-2">
                                        
                                        {% for detail in item.2 %}
                                            <li class="mb-2">Rp{{detail}}</li>
                                        {% endfor %}
                                    </ul>
                                </td>
                                <td>Rp{{item.3}}</td>
                        
                            </tr>
                            {% endfor %}
                        </tbody>
                        <tr>
                            <th colspan="8"  style="text-align:center;">Grand Total</th>
                            <td><b>Rp{{grandtotal}}</b></td>
                        </tr>
                    </table>
                    {% elif detailobjlokal %}
                    <h1 class="card-title">Laporan {{jenis_panen}}</h1>
                    <table class="table table-bordered" id="laporanlokal">
                        <thead class="table-light">
                            <tr>
                                <td>No</td>
                                <td>Tanggal</td>
                                <td>Nama Komoditas</td>
                                <td>Harga Komoditas</td>
                                <td>Jumlah Komoditas</td>
                                <td>Tanggal Kadaluwarsa</td>
                                <td>Subtotal</td>
                                <td>Total</td>
                            </tr>
                        </thead>
                        {% for item in detailobjlokal %}
                        <tbody class="table-dark">
                            <tr>
                                <td>{{forloop.counter}}</td>
                                <td>{{item.0.tanggal_panen}}</td>
                                <td>
                                    <ul class="mt-2">
                                        {% for detail in item.1 %}
                                            <li class="mb-2">{{detail.id_komoditas}}</li>
                                        {% endfor %}
                                        
                                    </ul>
                                </td>
                                <td>
                                    <ul class="mt-2">

                                        {% for detail in item.1 %}
                                            <li class="mb-2">Rp{{detail.id_komoditas.harga_beli}}</li>
                                        {% endfor %}
                                    </ul>
                                </td>
                                <td>
                                    <ul class="mt-2">

                                        {% for detail in item.1 %}
                                            <li class="mb-2">{{detail.kuantitas}}</li>
                                        {% endfor %}
                                    </ul>
                                </td>
                                <td>
                                    <ul class="mt-2">

                                        {% for detail in item.1 %}
                                            <li class="mb-2">{{detail.tanggal_kadaluwarsa}}</li>
                                        {% endfor %}
                                    </ul>
                                </td>

                                <td>
                                    <ul class="mt-2">

                                        {% for detail in item.2 %}
                                            <li class="mb-2">Rp{{detail}}</li>
                                        {% endfor %}
                                    </ul>
                                </td>
                                <td>Rp{{item.3}}</td>
                        
                            </tr>
                        </tbody>
                        {% endfor %}
                        <tr >
                            <th colspan="7"  style="text-align:center;">Grand Total</th>
                            <td><b>Rp{{grandtotallokal}}</b></td>
                        </tr>
                    </table>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
    
</div>

{% endblock %}
